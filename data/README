>>> import polars as pl

>>> a = pl.read_parquet("item_seq.parquet")
>>> a
shape: (1_000_000, 2)
┌─────────┬─────────────────────────┐
│ user_id ┆ item_seq                │
│ ---     ┆ ---                     │
│ i64     ┆ list[i64]               │
╞═════════╪═════════════════════════╡
│ 1       ┆ [87941, 36458, … 76024] │
│ 2       ┆ [19449, 36707, … 11585] │
│ 3       ┆ [50487, 45519, 59886]   │
│ 4       ┆ [73130, 13016, 4502]    │
│ 5       ┆ [71741, 58513, 14019]   │
│ …       ┆ …                       │
│ 999996  ┆ [77662, 57435, 15565]   │
│ 999997  ┆ [15541, 44230, … 22758] │
│ 999998  ┆ [73678, 85078, 18570]   │
│ 999999  ┆ [78629, 37174, … 31024] │
│ 1000000 ┆ [16658, 11375, 54971]   │
└─────────┴─────────────────────────┘


>>> a = pl.read_parquet("item_feature.parquet")
>>> a
shape: (91_717, 7)
┌─────────┬──────────────────────┬───────────────────┬─────────────┬─────────────┬─────────────────┬─────────────────────┐
│ item_id ┆ item_title           ┆ item_tags         ┆ likes_level ┆ views_level ┆ txt_emb_BERT    ┆ img_emb_CLIPRN50    │
│ ---     ┆ ---                  ┆ ---               ┆ ---         ┆ ---         ┆ ---             ┆ ---                 │
│ i64     ┆ str                  ┆ list[i64]         ┆ i64         ┆ i64         ┆ array[f32, 768] ┆ array[f32, 1024]    │
╞═════════╪══════════════════════╪═══════════════════╪═════════════╪═════════════╪═════════════════╪═════════════════════╡
│ 1       ┆ Leian #TheLastKnight ┆ [1]               ┆ 7           ┆ 2           ┆ [-0.356271,     ┆ [0.020264,          │
│         ┆ Ammishu #O…          ┆                   ┆             ┆             ┆ 0.290884, …     ┆ 0.050413, …         │
│         ┆                      ┆                   ┆             ┆             ┆ 0.2591…         ┆ -0.2644…            │
│ 2       ┆ If the heart is      ┆ [2, 3, 4]         ┆ 5           ┆ 9           ┆ [-0.329836,     ┆ [0.006482,          │
│         ┆ gone, use a st…      ┆                   ┆             ┆             ┆ 0.304386, …     ┆ -0.018151, …        │
│         ┆                      ┆                   ┆             ┆             ┆ 0.0730…         ┆ 0.1024…             │
│ 3       ┆ "I Lead the Empress  ┆ [5, 6, 7]         ┆ 2           ┆ 2           ┆ [-0.251587,     ┆ [-0.028489,         │
│         ┆ to Battle …          ┆                   ┆             ┆             ┆ 0.369733, …     ┆ -0.003908, … -0.12… │
│         ┆                      ┆                   ┆             ┆             ┆ 0.0829…         ┆                     │
│ 4       ┆ It's all             ┆ [8, 9]            ┆ 2           ┆ 1           ┆ [-0.475041,     ┆ [0.00047,           │
│         ┆ superfluous! #Naruto ┆                   ┆             ┆             ┆ 0.137045, …     ┆ -0.012785, …        │
│         ┆ …                    ┆                   ┆             ┆             ┆ 0.0657…         ┆ -0.1264…            │
│ 5       ┆ #NoHeartbeatChalleng ┆ [10, 11, 12]      ┆ 7           ┆ 5           ┆ [-0.526645,     ┆ [-0.036546,         │
│         ┆ e made me …          ┆                   ┆             ┆             ┆ 0.383219, …     ┆ -0.012415, … -0.03… │
│         ┆                      ┆                   ┆             ┆             ┆ 0.3220…         ┆                     │
│ …       ┆ …                    ┆ …                 ┆ …           ┆ …           ┆ …               ┆ …                   │
│ 91713   ┆ Visiting a friend's  ┆ []                ┆ 7           ┆ 8           ┆ [-0.193623,     ┆ [-0.019638,         │
│         ┆ new house,…          ┆                   ┆             ┆             ┆ 0.276843, …     ┆ 0.006561, … -0.044… │
│         ┆                      ┆                   ┆             ┆             ┆ 0.0794…         ┆                     │
│ 91714   ┆ People from          ┆ [9850, 1033, 412] ┆ 10          ┆ 10          ┆ [-0.339541,     ┆ [-0.054992,         │
│         ┆ different countrie…  ┆                   ┆             ┆             ┆ 0.521229, …     ┆ -0.005488, … 0.081… │
│         ┆                      ┆                   ┆             ┆             ┆ 0.1217…         ┆                     │
│ 91715   ┆ 20 Dian Wei VS 20    ┆ [161]             ┆ 7           ┆ 6           ┆ [-0.260083,     ┆ [-0.065525,         │
│         ┆ King Kai #Ga…        ┆                   ┆             ┆             ┆ 0.132122, …     ┆ -0.02824, … -0.149… │
│         ┆                      ┆                   ┆             ┆             ┆ 0.0474…         ┆                     │
│ 91716   ┆ Mutated Team         ┆ [809, 375, 161]   ┆ 8           ┆ 6           ┆ [-0.330233,     ┆ [0.004153, 0.01531, │
│         ┆ Deathmatch invinc…   ┆                   ┆             ┆             ┆ 0.299614, …     ┆ … -0.14691…         │
│         ┆                      ┆                   ┆             ┆             ┆ 0.0400…         ┆                     │
│ 91717   ┆ A JK after eating    ┆ []                ┆ 10          ┆ 10          ┆ [-0.327359,     ┆ [0.00272, 0.001836, │
│         ┆ her fill             ┆                   ┆             ┆             ┆ 0.356602, …     ┆ … -0.00081…         │
│         ┆                      ┆                   ┆             ┆             ┆ 0.2886…         ┆                     │
└─────────┴──────────────────────┴───────────────────┴─────────────┴─────────────┴─────────────────┴─────────────────────┘


>>> a = pl.read_parquet("item_emb.parquet")
>>> a
shape: (91_717, 5)
┌─────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬──────────────────────────┐
│ item_id ┆ item_emb_d128_v1          ┆ item_emb_d128_v2          ┆ item_emb_d128_v3          ┆ item_emb_d128_e4         │
│ ---     ┆ ---                       ┆ ---                       ┆ ---                       ┆ ---                      │
│ i64     ┆ array[f32, 128]           ┆ array[f32, 128]           ┆ array[f32, 128]           ┆ array[f32, 128]          │
╞═════════╪═══════════════════════════╪═══════════════════════════╪═══════════════════════════╪══════════════════════════╡
│ 1       ┆ [-0.568626, -0.316909, …  ┆ [0.25328, -0.363048, …    ┆ [-0.587753, -0.384626, …  ┆ [-0.568618, -0.316907, … │
│         ┆ 0.062…                    ┆ -0.0403…                  ┆ -0.19…                    ┆ 0.018…                   │
│ 2       ┆ [-2.512685, 1.534671, …   ┆ [-0.230919, -0.850652, …  ┆ [-2.505449, 1.560583, …   ┆ [-2.512688, 1.534621, …  │
│         ┆ 0.0071…                   ┆ -0.06…                    ┆ 0.0067…                   ┆ 0.0574…                  │
│ 3       ┆ [-1.028199, 1.078451, …   ┆ [0.360529, -0.137434, …   ┆ [-1.039119, 1.03167, …    ┆ [-1.0282, 1.078449, …    │
│         ┆ 0.1087…                   ┆ -0.048…                   ┆ -0.0019…                  ┆ -0.03317…                │
│ 4       ┆ [0.127066, -0.751923, …   ┆ [0.439554, 0.146667, …    ┆ [0.112834, -0.795698, …   ┆ [0.127066, -0.751925, …  │
│         ┆ -0.050…                   ┆ -0.0071…                  ┆ 0.0836…                   ┆ 0.0078…                  │
│ 5       ┆ [0.606792, -0.328726, …   ┆ [-0.234036, -0.130848, …  ┆ [0.606952, -0.308142, …   ┆ [0.606792, -0.328725, …  │
│         ┆ 0.0111…                   ┆ 0.022…                    ┆ 0.0644…                   ┆ -0.004…                  │
│ …       ┆ …                         ┆ …                         ┆ …                         ┆ …                        │
│ 91713   ┆ [-0.981536, 0.105555, …   ┆ [-0.376103, -0.564813, …  ┆ [-0.974489, 0.175429, …   ┆ [-0.981536, 0.105554, …  │
│         ┆ 0.0089…                   ┆ 0.048…                    ┆ 0.0495…                   ┆ 0.0476…                  │
│ 91714   ┆ [-0.3548, -0.032913, …    ┆ [-0.258115, -0.945421, …  ┆ [-0.354467, 0.021998, …   ┆ [-0.3548, -0.032912, …   │
│         ┆ 0.01773…                  ┆ -0.00…                    ┆ -0.083…                   ┆ -0.0047…                 │
│ 91715   ┆ [-1.065262, -1.014313, …  ┆ [1.284586, -0.192023, …   ┆ [-1.11897, -1.150496, …   ┆ [-1.065262, -1.014314, … │
│         ┆ 0.102…                    ┆ 0.0100…                   ┆ -0.131…                   ┆ -0.05…                   │
│ 91716   ┆ [-0.129101, 0.257504, …   ┆ [0.678855, 0.216474, …    ┆ [-0.147603, 0.17668, …    ┆ [-0.129101, 0.257507, …  │
│         ┆ -0.010…                   ┆ -0.0556…                  ┆ 0.00925…                  ┆ -0.005…                  │
│ 91717   ┆ [-1.108214, -2.386264, …  ┆ [-0.096376, -0.653023, …  ┆ [-1.121962, -2.338913, …  ┆ [-1.108214, -2.386266, … │
│         ┆ -0.09…                    ┆ 0.000…                    ┆ 0.172…                    ┆ 0.050…                   │
└─────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴──────────────────────────┘


# NOTE: The first row in item_info.parquet is used for padding. Please make sure to keep it when rewriting new item embeddings.
>>> a = pl.read_parquet("MicroLens_1M_x1/item_info.parquet")
>>> a
shape: (91_718, 3)
┌─────────┬───────────────┬─────────────────────────────────┐
│ item_id ┆ item_tags     ┆ item_emb_d128                   │
│ ---     ┆ ---           ┆ ---                             │
│ i64     ┆ array[i64, 5] ┆ array[f64, 128]                 │
╞═════════╪═══════════════╪═════════════════════════════════╡
│ 0       ┆ [0, 0, … 0]   ┆ [0.0, 0.0, … 0.0]               │
│ 1       ┆ [0, 0, … 1]   ┆ [-0.587725, -0.384628, … -0.05… │
│ 2       ┆ [0, 0, … 4]   ┆ [-2.50544, 1.56058, … 0.154814… │
│ 3       ┆ [0, 0, … 7]   ┆ [-1.039118, 1.03167, … -0.0681… │
│ 4       ┆ [0, 0, … 9]   ┆ [0.112833, -0.795698, … -0.024… │
│ …       ┆ …             ┆ …                               │
│ 91713   ┆ [0, 0, … 0]   ┆ [-0.974488, 0.175429, … 0.1062… │
│ 91714   ┆ [0, 0, … 412] ┆ [-0.354467, 0.021998, … -0.074… │
│ 91715   ┆ [0, 0, … 161] ┆ [-1.118971, -1.150495, … 0.013… │
│ 91716   ┆ [0, 0, … 161] ┆ [-0.147602, 0.176681, … -0.021… │
│ 91717   ┆ [0, 0, … 0]   ┆ [-1.121965, -2.338915, … 0.192… │
└─────────┴───────────────┴─────────────────────────────────┘

>>> a = pl.read_parquet("MicroLens_1M_x1/train.parquet")
>>> a
shape: (3_600_000, 6)
┌─────────┬─────────────────┬─────────┬─────────────┬─────────────┬───────┐
│ user_id ┆ item_seq        ┆ item_id ┆ likes_level ┆ views_level ┆ label │
│ ---     ┆ ---             ┆ ---     ┆ ---         ┆ ---         ┆ ---   │
│ i64     ┆ array[i64, 64]  ┆ i64     ┆ i64         ┆ i64         ┆ i64   │
╞═════════╪═════════════════╪═════════╪═════════════╪═════════════╪═══════╡
│ 861687  ┆ [0, 0, … 49029] ┆ 33811   ┆ 4           ┆ 4           ┆ 0     │
│ 210622  ┆ [0, 0, … 59837] ┆ 12875   ┆ 9           ┆ 5           ┆ 1     │
│ 861880  ┆ [0, 0, … 29432] ┆ 1678    ┆ 9           ┆ 8           ┆ 1     │
│ 767068  ┆ [0, 0, … 77444] ┆ 76303   ┆ 6           ┆ 2           ┆ 0     │
│ 745698  ┆ [0, 0, … 46774] ┆ 2561    ┆ 8           ┆ 6           ┆ 0     │
│ …       ┆ …               ┆ …       ┆ …           ┆ …           ┆ …     │
│ 676432  ┆ [0, 0, … 85743] ┆ 20877   ┆ 3           ┆ 1           ┆ 0     │
│ 992563  ┆ [0, 0, … 35678] ┆ 66434   ┆ 9           ┆ 7           ┆ 0     │
│ 306906  ┆ [0, 0, … 75160] ┆ 29448   ┆ 7           ┆ 6           ┆ 0     │
│ 702721  ┆ [0, 0, … 49943] ┆ 51587   ┆ 7           ┆ 6           ┆ 0     │
│ 110185  ┆ [0, 0, … 82916] ┆ 47331   ┆ 8           ┆ 7           ┆ 1     │
└─────────┴─────────────────┴─────────┴─────────────┴─────────────┴───────┘


>>> a = pl.read_parquet("MicroLens_1M_x1/valid.parquet")
>>> a
shape: (10_000, 6)
┌─────────┬─────────────────┬─────────┬─────────────┬─────────────┬───────┐
│ user_id ┆ item_seq        ┆ item_id ┆ likes_level ┆ views_level ┆ label │
│ ---     ┆ ---             ┆ ---     ┆ ---         ┆ ---         ┆ ---   │
│ i64     ┆ array[i64, 64]  ┆ i64     ┆ i64         ┆ i64         ┆ i64   │
╞═════════╪═════════════════╪═════════╪═════════════╪═════════════╪═══════╡
│ 796130  ┆ [0, 0, … 50705] ┆ 72699   ┆ 6           ┆ 4           ┆ 0     │
│ 129725  ┆ [0, 0, … 79271] ┆ 19550   ┆ 7           ┆ 3           ┆ 0     │
│ 466858  ┆ [0, 0, … 44587] ┆ 81769   ┆ 7           ┆ 4           ┆ 0     │
│ 901560  ┆ [0, 0, … 89045] ┆ 86627   ┆ 10          ┆ 9           ┆ 1     │
│ 530007  ┆ [0, 0, … 23103] ┆ 29767   ┆ 9           ┆ 9           ┆ 0     │
│ …       ┆ …               ┆ …       ┆ …           ┆ …           ┆ …     │
│ 431517  ┆ [0, 0, … 7421]  ┆ 55027   ┆ 10          ┆ 10          ┆ 0     │
│ 749964  ┆ [0, 0, … 53404] ┆ 49316   ┆ 5           ┆ 3           ┆ 0     │
│ 715096  ┆ [0, 0, … 52405] ┆ 62872   ┆ 10          ┆ 10          ┆ 0     │
│ 125803  ┆ [0, 0, … 19557] ┆ 190     ┆ 10          ┆ 10          ┆ 0     │
│ 801050  ┆ [0, 0, … 37666] ┆ 86766   ┆ 4           ┆ 1           ┆ 0     │
└─────────┴─────────────────┴─────────┴─────────────┴─────────────┴───────┘

>>> a = pl.read_parquet("MicroLens_1M_x1/test.parquet")
>>> a
shape: (379_142, 6)
┌────────┬─────────┬─────────────────┬─────────┬─────────────┬─────────────┐
│ ID     ┆ user_id ┆ item_seq        ┆ item_id ┆ likes_level ┆ views_level │
│ ---    ┆ ---     ┆ ---             ┆ ---     ┆ ---         ┆ ---         │
│ i64    ┆ i64     ┆ array[i64, 64]  ┆ i64     ┆ i64         ┆ i64         │
╞════════╪═════════╪═════════════════╪═════════╪═════════════╪═════════════╡
│ 0      ┆ 792201  ┆ [0, 0, … 36483] ┆ 32236   ┆ 8           ┆ 6           │
│ 1      ┆ 20380   ┆ [0, 0, … 76342] ┆ 4089    ┆ 8           ┆ 4           │
│ 2      ┆ 273032  ┆ [0, 0, … 3229]  ┆ 35399   ┆ 6           ┆ 5           │
│ 3      ┆ 490677  ┆ [0, 0, … 84160] ┆ 14875   ┆ 9           ┆ 6           │
│ 4      ┆ 474784  ┆ [0, 0, … 45495] ┆ 72452   ┆ 8           ┆ 3           │
│ …      ┆ …       ┆ …               ┆ …       ┆ …           ┆ …           │
│ 379137 ┆ 431758  ┆ [0, 0, … 74168] ┆ 42661   ┆ 10          ┆ 8           │
│ 379138 ┆ 560433  ┆ [0, 0, … 74457] ┆ 22205   ┆ 5           ┆ 1           │
│ 379139 ┆ 383965  ┆ [0, 0, … 51061] ┆ 52478   ┆ 5           ┆ 2           │
│ 379140 ┆ 100524  ┆ [0, 0, … 2628]  ┆ 14197   ┆ 10          ┆ 10          │
│ 379141 ┆ 15257   ┆ [0, 0, … 47205] ┆ 77091   ┆ 9           ┆ 7           │
└────────┴─────────┴─────────────────┴─────────┴─────────────┴─────────────┘

>>> a = pl.read_csv("submission_sample.csv")
>>> a
shape: (379_142, 4)
┌────────┬────────────┬────────────┬──────────────┐
│ ID     ┆ task1-pred ┆ task2-pred ┆ task1&2-pred │
│ ---    ┆ ---        ┆ ---        ┆ ---          │
│ i64    ┆ f64        ┆ f64        ┆ f64          │
╞════════╪════════════╪════════════╪══════════════╡
│ 0      ┆ 0.954083   ┆ 0.954083   ┆ 0.954083     │
│ 1      ┆ 0.999789   ┆ 0.999789   ┆ 0.999789     │
│ 2      ┆ 0.979571   ┆ 0.979571   ┆ 0.979571     │
│ 3      ┆ 0.000024   ┆ 0.000024   ┆ 0.000024     │
│ 4      ┆ 0.00292    ┆ 0.00292    ┆ 0.00292      │
│ …      ┆ …          ┆ …          ┆ …            │
│ 379137 ┆ 0.999421   ┆ 0.999421   ┆ 0.999421     │
│ 379138 ┆ 0.198265   ┆ 0.198265   ┆ 0.198265     │
│ 379139 ┆ 0.999619   ┆ 0.999619   ┆ 0.999619     │
│ 379140 ┆ 0.999585   ┆ 0.999585   ┆ 0.999585     │
│ 379141 ┆ 0.777363   ┆ 0.777363   ┆ 0.777363     │
└────────┴────────────┴────────────┴──────────────┘

